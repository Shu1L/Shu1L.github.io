<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  
    
      
    

    
  

  
    
    
    <link href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="免杀," />





  <link rel="alternate" href="/atom.xml" title="Shu1L's blog" type="application/atom+xml" />






<meta name="description" content="Here&#39;s something encrypted, password is required to continue reading.">
<meta property="og:type" content="article">
<meta property="og:title" content="powershell加载shellcode免杀">
<meta property="og:url" content="https://shu1l.github.io/2021/08/06/powershell-jia-zai-shellcode-mian-sha/index.html">
<meta property="og:site_name" content="Shu1L&#39;s blog">
<meta property="og:description" content="Here&#39;s something encrypted, password is required to continue reading.">
<meta property="article:published_time" content="2021-08-06T06:00:40.000Z">
<meta property="article:modified_time" content="2021-08-06T06:06:53.519Z">
<meta property="article:author" content="Shu1L">
<meta property="article:tag" content="免杀">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://shu1l.github.io/2021/08/06/powershell-jia-zai-shellcode-mian-sha/"/>





  <title>powershell加载shellcode免杀 | Shu1L's blog</title>
  








<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shu1L's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一只菜鸟白帽子</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://shu1l.github.io/2021/08/06/powershell-jia-zai-shellcode-mian-sha/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shu1L">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shu1L's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">powershell加载shellcode免杀</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2021-08-06T14:00:40+08:00">
                2021-08-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <div class="hbe-input-container">
  <input type="password" id="hbePass" placeholder="" />
    <label for="hbePass">Hey, password is required here.</label>
    <div class="bottom-line"></div>
  </div>
  <script id="hbeData" type="hbeData" data-hmacdigest="30d9d7a4d1e6ed862a11c8cd2d788cb96bd4f6905cadb05dec149d5af15fef67">9d7d906d08614c905e74223eed3f6e932fd62930d2fcb8efbf58024dd42ca5d10c819725b81edfacafe2b313638c14f984f1074dff3ca9638c064e0b3a061dec0f212bcaec5ac380896303032145ab1f431ab144198f3bf71cce1b6c39269843129a6bb87442528ee30827f8e96884e48722fdef4edbddf7bde0295e9b31e6bc899e58817e8949040c5eeab6b5fa4e6290f57d767654296fce63b174649311d0627675dd60c849eabc47ff4d7a7f2133710a40514de206e33922a524f6ed13fdb2d670c44d43fdc77d73042790c265a6cb6a4651b2b909f4f6631fe803377b73a1de91064ce9464fc262b3538e595145fa8fc951f296d9353b8777212915d6f2c9c4b7c1bedcb1c2e3a7a7ec228117f973464d17894b612911e9520b063c819eeb7c8d0464da09af6ff3e3372ed0bdb009d2031d3359a99fe351f55582945716becdeb45e42b3944d9b895c5c23e22c2f65882cfb7070f302dfbd77647ad05d7a5ef1474342366b6f0bbf187fa2680277ddb0977e45441eb807b48fed484d1251851a4e04a11313e73503e95ca9ae57275982f1803408a1101e34124f8d6a28b4cdb7b63374885ad43ec748253208c461ebc52b0a008fcd5492fb9066b34467388635e7975242d5359b785b220a68054ad84424b18a35ffe264cc92879342535909b780f0800e43058840dbce5b6a23105d211bffe1fe477fbc407dbaceea178745001054ba77e0c17ba3c9adc76c69a288caecd4b8cd388d584dbc48841862b2a8432b1662964dfd24e22335b562d9fc6407232e0d34e5592f3d60cbe8534144a8d2b946ea038c80c68d747d79a36a0a049b8e7676ecac1dfb51b547d2d6c9ca720e686c01c9ba7ebfdcc5a34bacc11267f11f3627c7766c226c7474e5f3b53f0436a1c7894bd3c8221a30c13cdc0d572208a6913a5a90f87c844b7bcc1b887cecf23f93d46488ceb2bf195afeaef6d960b2604eeb4a395c7ca734f9aa7a7d86323b4944093782eda90f4bf35f3b2557f84f4bfbe120ee389852e38658d64b6bdca6cfac8f4efb20d66e078954bd7641c214754602ad949f007c818db9e027f3b65d18c3f5939a13068c21d1aeade7b6b8ba3297ad283c700ca8561c1bb55b4d90c77573f5f6b707625574a06a4ba6c21705ed45bef00cea38f50e8df22f2587e9d093cad88849abf3157bb692b94d261e873c1ed67a832cbd673785707f406ac45ae4a7c47d5622e27544f94bde4d5fc506d77e64f93a50862982e51fe4de44b0662e06883b1730387ab3f0e04805cfe0f0840b4264908115955311f5f617c34868ba0cbc29785a1ce3c1c7d3fcec3f1dff88ada21bb706b2dde0ff5152aeeaa13dca623f103f2791a77c319bce01ade789287503b42647c025506f3bd4359a4dc6e7ae48780da1252d50d50a87c6bbf318e2db4db2e5cdcd1ef8a06f97298bafb0fccaee89993bba5eefce28d00efb675a149762d1344e1eeb5be62f5b0c80508f809f467f4573b65a218a47ebc2025826784ebccf7bf212d670038a9b594a44ca3cd995a80a4bc8a0393439dd30fc0acff3c6e3fc871ddc619d5e1c113eada1b845feeaf4ab642ea15477c1dcd6fd40f8fa0337e415c5f84adf0c8da61a941b0f4f2be2238dccd5cb7ce1d08dc864321995eac8f8fc09aaa53aa9172ee74c20d67886bc1620abed7bdac987883e653ebf374348851ea89e3b4b7c9997f7d695b78d084daacdf2c894a5ad8553754033593df0c17931ece44709c33ac54abd9e0887d768d8353718e0af5fb988baf14ae2b88af50ede7f913db78b755c3335754225f910737dbeb9719da5693a694eb63fdad3fb77861f2663bebc9fd939da27c538dff315480fa9df74c0946bcf719a5a20d9cbc971e0c52df9298a98178c83c3e01013e6e84fb67550479af66bb022b7eb9f60ccd6957b0a7d1f9e0acfc390f032c2716a3674d2e9bc7e0e7ee8a4301fe40e6a5a6e52d63e5d123274c384b51a447cb3a397c852f8fe7668b66a778587f31ecddea83a118f4f7fd320c024cbbd83ca4e16cd11b2b02f18e68816187c4de14ccc7b948ecb5bac5bb548299c3dab1cd408e60cce28a4371347fed4783df3fdd9236bb8258b9a76dc6526c1ea1721ed684c716120a9bcfaf65e2b60f3a3cc0723f59fb5c4143b972f001a8aa397152f478810dc21874f04af74231ccf2ca1bb85db65839c3a5c626ecd1c4063f29f0219ce675ff7d6dc9e30093a3513dc96c6f73320eb75fe1bdd2caffeb4899c5dd776516c6f52e5855615d32750ee0b2edc7582fc5c4999921b90bb95f8193fe56323c55422ff38cea4c08eaf5488397520da45b5f007c8feb11d1f9b97dd31cc4f67815a0c82c97976a0051fe901415871d35dd36d0d0d207ce2859d5aeac071754db3b0275aef5bacf7f3c49f806eeda131869cea49bbb126e123ea489d6b652881f7bc1886a7b848fdeff4d370f96b02e03380fc78044557dc60dd7f526b6c2baca4a71e0a3d58c897d5e75d9cc1b4674779bcc4ce54cb6d1f600b660df3997e8f1c9b386bfc8aab2d61753f25633d6e8cab09caf6262d4f3091c5ec87cce7c11c57625096a81259a75877cc95a72a710c4ca8981147d37f77d12841a57c059e43a9b9f050e09f2694890bdd4ef89529872e2aad1e58f7730ce42fd5895aea362f5b4377721ee9a56681eb8e1a20673ae81bdea5121682f93a73056070decfda2266cf41e0b20aedc5bdba672299c04b90de7484c71fda49cb09b31433fe9b8cdb3c9c7370d28c333dd048cf877ee25ac8637762ffa7defd30a704c106ed26a2dc83d8df09e211be55a87c148dfe4c3a9553de96e8231eb0c1f05f7151c34b95e9bccef69760948315bddba9c6dc39854c9c48692861f6a22e1df134385b6dcdb0c01782f6f83bc0d22dda42eb529443d60213d2da6cdb0f140437b817f5d8507edd25d646f82bfbbc92fdc10bedd3e090b029ef5f4e57f21ee3801b65c41ee76e2478eb17ade092099e7378ff3db61818b757719cf0b67ea7d2a7516027969660dabf01ac7e555c444ccf11e9d51403e8efaee543b6259c755476aaf9575abbca02b7a1daf57753a4b0095c19370d174d235d397a57df775940396e4069e0345ada509a6f17a46a9580dc8a98fabdae70e9b38c616a5a3f31760208e38ebf97a4343b595c592c88278b7ba0151a57abec2b2264bac3a703814b5e94fc8ceb466580918654849a39e330a1022d5fcad63aec7d073f4e2ab2e79ee242a59272af0295c43a4b47730ea50657cce68a72ed0318ccf36ba6dd3899863865e34b8406be4357931cb1016c292fcd802a64cea7b6d7eba76c04ee70501f4add1a4cfe081cee89d3ee1ddfd318af588e67db8bb66197a8c93005fbb70afd71f04ad0b6d47cfd01db10b70f60eee072c9077d4cb94de3fa49913064744b35431fe425f7f076deb32daa54a5597eece62260be4d13f9d485cf359df630f9a1a544460dfffcb47e40bc4c99b62fc2dc5130a655e32026c352bb9f9bff33ce1bbfbaf06317691528166c1f76cb6e18492f37daac2e2d15aa3b352787b61c4108ad8d96859c3eddd17dad6086d33f06b44635cc7044477f73ca697613a1b2ff9575edddbb1537aa48eaa849dd601ac339e281260451f34b4037c045484f979d3ccc3eee464214b482a67ec22cf18e6d31977cff23b5fabd5960e72c55b15c21cceabd5ef1336da36cdd6f2fde08b3d50a54eafe35a243b7ad43a03544ae712e35954a7e17905822bbbb8f73fe62b0a0212ca8b3948fbd7fb272900fc688b128c2c3d7809fab2708f890a23f26638b0cb7618e5e41223f1a3ad15cd149379a98b7be77d2b692caa696644450fa1043d9ec89c5338931301449943c209266d538cb6c0908f4a0ef7f0b87444686b5ebe36dba88b042db0a188aa214914e31e9c1dbdca43bec9399e730a73a2dbddf5d08da7075de4c0d6316174e3bbf8acf9ececc471582962aaf6484d566040dbb6c6580aa959863443c9523bb9629ac8579ebb90312c0574c5f168a610f17bc2c09728a37c75e236ac8f4e932fbf6a5e7f8ee4d6230cbc0159f3aee4d4f7c24f0ac9d4ed3b28731438dcb95ea30fb9626950c9171940c961dba45f63d5b526374c2008f3f5c92264d8626457f91fde7add8395782493e64f0c19b8c4ea8f76adf4da22f6d570897ae3048fc3da4d484966bd717d2db404f702fa5e6cea93f72502e5be32067e47750eb83d64aefae6b36cb6fbe38ef22381be8f68b3094262ea4f98fd3bd073792146a6ad00ec0ff487d6121a56777a81f9a3476147c90768a93658f92bf83a7ae743f8f2e9b502f628656aff911f03630d33459814702f4e48dba54f0db9eadfa309fa80b59029a740c520747a49915515e1c26efa9f2f56ec71b1d9237653ea0549816b2c1b569f4545698890c823b8b92d3a3556f3f396153d8d2304b3ef68202dfd3aa439dcf29ffd208d2162c164317634a8e253c92ac4f70eb418d8b47f6e4b5759b03a1d15c0d4a340b99370a083b2a8f3a9448d1f084203060fa42243f2d2e26dfb0b011640cb626999586bf0027bedab47bcb5062131fc49c7f8185dc996fd36fea97a268bf3a60feb052dfbc2dee8c6e53aa6cae9a593c6a7409a69c6011aa393b007ef57858371ef2735144d6ec4f6a20896509e2d10172b8070b59d47bd3ffd57193aa693e7f8aa72f7037b05040238cb23d85956264bb9cc4fdda519a0e52924b99c69087304781a64ae9985c1ac25fcca0c3cf4f36ef1b5511c038e0e784f771ee7c8a90d0db81bb2b948e02b58074ffe74864537f702f430244c030fc912ea76e551a2f778e6e6150fb5c6a9a112a169b16e23fd646cb2d9eebedf56d2d2dff995f1b64e4917768cc5eaa8368fd56f1e39c0dcd01f720a85d92d4437329d3c8206124cead859eed36cdfeb295ca9b487586cd66531b404046d6cd6a74593c3f429852ad13bbf4be952b4614e88e2e8d5a31c7c3ea3bc94b8ec76d4d38913d0b17e394aa977744384a20e320b4dc232add4da121fe73cf7ab7c59e1f147dc1a5cb0d970143b91cfbd07a1af9d46cdaf71963c0d87b054557fd6fe5ae554a478e58d0edef9fae9624f20c678c1b8d3505ede5769a0a695215bbd31e794b357811cead22374bdf799750f9915fbf5b11df743d57fdb302dd80a538dc7e8e38874dff0a6293644796f7d03815e27d4f1bb0cae6260b70f4d163480d75f8c434794fded6dd426cbd73c4cba99e9f961933bd7bbaf7e5ebf2c2bd813bb603a901a693dafcc647dc01ad24ae15fbb3f55890e13536fb83b6c781f717359044c848b197a9f95b2080e28f4693b22a8fa893be6d8a8f1e719b316676b162d4bdcc20301f490b6eb80ac474595cce9c88e16f1ac74444d8134b7527693442a4f60e566a34ecfe9fb9e77de55f32553dd69a3eb3f43d2f745f941e77fa4ed1ddf199a9ff583b5ae265049ceec23f50b7a19ae9adc94425f7dcdbcb75c57977e6d96ea8c433cb8263dbb774e85eb0c0a268015ab3fe40ca13abe3406fd028dccf8ab416367251f26abd18e426d35c359d79e305ba71daa800ea5a44584f56f8e8e3b27457fd4cac3ee1ec264e65916d3e1fb403822200b71ccb1b31cb1bdfc5f75dbea419c7e6c94546b867ed682b7d287facee7851d393845f1451c1da413310ecbfbac54a98d9d60c63e9fa8509b7c888d7e4469d5e3d2838129275a78a9aae2e51adf46662f37f38fe0d2f35df517ba446a65bc7eeda07a46b39a5de270949a9d319cb05d0d3495f8544979e62cf3cd6e2a69ae89bfea146dd82390983e00475743e9055d927e9cb7e512eaa118c0c2d2c57d524bed57aecaf0085ef052b6eac7602fc39d40f7481722d8cdfd3b3c30a57dc95bea900fd7991d0a7adeb6112c9ef4195b1a9aacc68ebcb0f9fdc9768cc7d46b2bef6678b544ad05e2a0b1f4275308af80012d4a87bcab8d7d0a190375d168a65e262d04d20450360ecbaffd882bda5cfa12175628cb16666f750c56951948a28554e92b12f825d935e7648ddbe71241e86d76f2f7be9504642cdd83519d0aa18d9c10736dda620bd94108276f65bac7ac2b9a8bf0cea01ee56d6b820045fb04707545220cc02d94c3c03c455f7cf16d1f6674e69a381e24de41f19aee448f19024bf1414d533533cf7a556e9894bfdc78d99e5957c429e8f0804c22d67df559b97c625fb720b6c43fbf2cf8617edafc88cb9ed84cca0111a94a967c2e0ac9b3a80fc7585ec0b22a6b823f87b6c74c1b29340ff6306a5a1c042defa932198986811ec11c0b30df24c9a50b4f9d9edbebb50a44ab486d2c02a7cd12a08e61e53f1f1471da0b64b7278795db5b6de0633a241919bdfe87e2e3a49f05b844eb213a0954006bee11b11c9de2e5324e8b79b233eb062774102869681a3120944a85dc1ffe48a02b018b11330abd9e1905b49f6023fe42bd1645f0d5a0daec5c429c1abd327e9f2e3d5d29e0b781cef5884bcd3888e0ecc7b79d0c88b37f033ff16a0342a9fa4ecdc06250f916e687b5c5ac802dbc19835063b990afa710bef01f5f1e97f00aea17143aab4d28bf28aa380a4aee9cbaca39994be42a78fc2623d4f5930c891fcf08aeb312354b98e722635d2665285cc27abe25a646e4b7de47118acbdbc59439bb6a73503019d1c856d4145bc0b0a0c6132a6ab469795a357b4372f89e1febc102344e30e6e6a918e28849fcfcaa94b28a00573577a8d4e10ffb1c9111906a904956cb772659b299ebb085b2bef204953ef2f8295b77d01fdd17d1fa97962d072f2b766e727a66f2ceea7a5ba2dfa7560e45a17be239a79c83aa4ac7f4f85dbda40b51a345ae9cc7ec5ed6ed272a046437237fd17d1a294b7d06132a4c0e6dacc1b6d28fde3d5c9a9244a9fbde74cdc7254bda4bdd8ea3413d66a02b32dda7458cb5ed91ec05d60bde7ba8469c4803deb89a1ec68061d1868af5a4cc6c9443fecc3dad5f731a8dfd0a42850a42a89be1f3f68753df7c0feb66edcae85e09d6c8885041f5ce9524dcf963bf0583a396b3210ad08293444304b121485dec057ae7a6b8dd18a049332fca1670d65b1b8612bfeab9f78529a9a03423919feaee57121520214be2d5d934943ae50f8b9b323db7a4635cd859bc77653189e01acf380ea1db3023a64a37f6080f5c7b229bb2cfbef9f9c34598c80048d1fa53ba27a8b600c9cee82bf7a645c3c7b6968fb194225fc2ac5e06bb59529307858b4e0f5a173e9cf7b01c0644f64dde0de296e53a3cba601866e6f6dc14e39daba88bbd6208fce3465c45c412f562504939e32007579bcb080da4d5192211b979d8ce085c99f2b0c4420e18eaab9ac6c3bb572d45a4d764590d17aa43070544fd7cb25fc19f4660885c526717062180a60cb718ebd077d22a366fe783a9650ef0ac2a80f0fe52bbb68c673aa3e83e5f5a75dbdbf09d6b3f269c6fd5131b986b464f0b91cb5135b0fe107f00f6d1adee40eda2a8c3a14ba0d40358d9bcd9a939429f6c2a0b6ff5c30f0ba92c702b43ec863d0b70e2bd8492dcf9cc1eb6453b308c47ececaabedea428be03efa5913217d89f9e94cfd97014bd94d87bee2119fcafe0095ada5777dc60cb516de6d852a78842a6ca4fb7ad3bcdee49ca1d60237bd9d8ad3fd00ce487528d7321931e74d21282feae0e75dca4b419c3d7f456f6ef195297688ca45bdf9a396bf1cb43197d32a1297afcb4e33f8b2985600269fff35ddca33af285ed812035738ea2d52f5dfd75cf9d557e49c924bed2456f0d2ec83d49a2ed2b5ff1aab8a304d74d10f95d63e089d35d41ecef9e7967226f14f51cc58999eb90607a9ce4a40b3bf2f275552868f8d28874385a7afc5f9bcc884d612d7f06ac4c3ae2827ff517e305dcff8e39a3c0fdbeef6335c36e5b80587664848cdcd9de8b1ce6a5c45b19241261234f8ebb6466575a9b5d5a1a7f8c44ef3910d01263c63c3d92bf909913fec8c9135234a655e7ccd1efc5dbcd4f935eb0528f19854e8053a8413e03ebbf997f0f6d033aa5b8dd0d70fc09e7e19818e6231f9590107b107bd95c45de22a8d6fa90eb5820a9efc705cc2d877ac77d8a97a0290667899bcc2ebfae230e594bb03ae32fe14a361fb5609c266093b54db7e62e54abf374469bbdb0647d5c9a032efc536d0ddbd6742c2fc8920ca99d11388376035e963f25401b298a5294aca8004a5fea980d88c8ebc7644d61f6cf25ea4f0e0a75b0e7a4d59ad9f91da639a603cb76c8437a1d3b8c793eeb9c4c293134eac93a50093c83a5a0e15f87b65a2d025f39582d5ef38240288207cfec550bdceaeefbcfdb9c871f8487e02c30201a36cba6e5db1ecfb0863a1bfa0677a704078b2723bdd9fb5d6bb0418c6b94e6dae98ccee13fa45fc14cd87ee95f64de9017c77b2c240156d82d25653cf8ebecaeb6b70b3877103822b56e214eb1814d0d837b78a2c799160826f7211ca67429b4df8a7da1388e6d86e0859f48326b6733171bc9fcd898ac5437dc5cd1832451d5cc5d2a014cfd34a7dcce6d9910344a91e2769d62e17cafe212c831f898a56ea7f4a60143e5f9de59b06b38650b39aba8434620c756562e32e5d240c2f50b87dee1a6f1150c2cd09045e2fdee2addc62efc2c0ba0c2ba4cfd9adda185516dd23adfd4b064f6172bef7f623d260ad4fcf0bae9d257b2aaa7dbb8ea112078b2e4032fd6073c9d4e7b72d9524aa3ca38a89c0d095e193c2c76a84e3954774e44e94c4f7923deb3eb514059dbce68d66d5a6aaa0594905aed4b3573b3a8854213ac20681e15e1d91f5486468e8153ae6c0a4f83c8772f5d07263add63f38916b984876c2229088ed0b5e724ff82104c8020b93b65074af3942ff63cab9bf1d73204f8724ddf3981a7bafd1e5b69bd177d26d9c70f3f9d4d25afa78e85847a49f6066cb6c8bfefb3d6d428d22efeee8ae8bb73a8f8901933b7204bd2d36a0c70cfaf5b0e2114e80f0809a7f74728861ad6a4c4ea36990065c9784d926a058de6fda5bd1053d3cbd992fca653988e57fc356046e6ce1b65ac4ce7418e1aa03ed6071fe6c5991a6ad7e5c959c4927f21691232ddd1ef47c053775093a88dcb665570c4522591909c945e0dda23de5e74c3787bd961ef63e22f8fba80477939e55b9a77cdbb96de45ee49cd18751edd7c68df3fb031f1352c051c6a0bd881d062fedbd2545f8cca5bfceb20dc4fbc3c71de770e77acf11b98244203346867178b31da32ca2d7e2b02cc65dcb805fe8caee55cf591621d283acf0ed43c0a354533f47589b0cd2934d967da86bcc9fca508e5f6666758a860b578f6c448c1794c75f1c06d076f72b966e7fc0f6abda75716a6b25df6080fd60d44931d0bc55368a96acf817dcf35e0ca2b2c1812a95b127df069ef47d16f71da2ecf18c6e43922bf1499d80d8303aecfbec31fe2782260cf70a7960ab1a93279651c33f6d41282639d9683b0e48acb4910931421b77cbcd8fc6d4f447b25aa6845f9bba001889e05e0584db9a12b9a06201e3d4783a3a20258ee217d78c9379ef5660ec1db7ab4cbbfc74d6c67b1dcc616a03d6a27c1758fdea18056575a55c757088ffa09bd312fb7400118b328b0d85408b78f7d0aed771be34a73f50181943716b9f2ee4ea89d133690d5d0783358c21336ee13042b71e23936b36f34cc746c56fc1c4376bdbd79c2264b661c3830a4d215e80545bc5e3cc014791b5dc2b326e67bae2aac167a5036be9721fdf9bef77a060073d02bac0593020944ca59639976405b409eb105f682330612f9a25188eaa6776ac2fe9a2ee56b2068f483c4fccad61ee53b53a2ce456983a66d8a3a0c9e0c7cf6d9c29c4aa49e893f9a0aafd736d094eaef67c8b4548387feec1a482e7b443a81ecca15b04bc5f7f734513fa96e42531d40f59f07777fcf682fe36f93ed3d409ec494cb139f83ff751b02301aa65bf0e731c0ad9354638a3de230f6ebd5f47e61831a9ed70946565213ad73455da84754b90e05fe8c19d6ac092bf06faddd048b559f7d2b280517079b8a6a6ecc47683772b3fded56f8f595db9cbbfa6fe0e33dc408bf70800e08ba20123f2ed84952906d5326ae5c76de54930b9f9ba4e79342e0c4e74bc00c8b1c7d3f014ec0e3d7ec5495970697b6a4dba202aa0b6bc9ce5535d2b996fee8499b61a55a492dae381e684a90c580412f2cc22acf1dbf703709f65e063441cdcbb0fa609373db7ec4a05e99d04ef552d45adb847f85e214884f79337ee2956c5011023a3fca4f328786aa30c470e6d0af112d2f1dcd850db66f55335611ed5763b4d9bd848bb352d1487b3854275a80bcef34c1abac874c5dc8716e8ee45df315c6ea2baa309ca75123ac4c5759cc6d57224c2ad0bb70f9c34342af8bf91d63befba9ce93c06acd8262bf6dd096ece5cc49ab2b2ae9504641f68d346f4e91a6b7955b7be8a4cc29c2b5a3fd816405537662c8cba4200432f8c5bd88388b3415699736c769a8d64020e4c8ecc967138cf68da3680c0f864b545dfe323f1df07bff144324417d63137907f42767678c16584402d9236494e91ca385495ca7b64392cd3c35eb5a6c264ed2f0f0a9d4302097a5566c5b640c6e3037fe4bbd1704ca4c441499b0b2d2892e337e9584043ab67cce26e6a84c2cb9c2bb03b446995890ed335b2aff9fc656b63baacbf896191a9b479bf37e0d6d996b08e6f0d7c60516d8632bcb091d983efcab924b9993016ac5845a7d5daba7a2e8f167b77ee37e05277f2ae6c5c221bd176d0b7087d809e2dacea81f453da3e7bd0cd09591aca544df66224f0851ff6bfca9c593239c95f5b8ae3fba0f94160fa62deb63fa0d7b761ed74d2bb205766bf8941b30aba96717ec0ec49babcd7fa39add6701aaa17bf5a6d350fe7888db1bfc8e81e880612a88a7f99f16d3ec5f64ce777d35c6217e048f10059cfcd69c35ed7c745bd5db3dcc115ac30df428719aba5a1ab77e0f9c0834314a5ca16f752cdbb10df12e36cf6d6dae37f458bf51b268f6897ec015edcdbb27631dc921548005caf08d1e028880801139e43d82a8df12469cd3ed653dfa50a5b753fe995142d8bf7b946299c65a478f67b3c7192a134430c0f6259b0def1326fe8dd764f49ac30edd697035d1b4d04ef7d63a4c067124f84dbe61b5518b18db25b61de36922cce0b712a3a75ec943612b4a49a57113e948268d915e7784d0d3c5273d64fe04d6537bbc5d7e1d9473cb9eb6570f4be84737ead75ecc79b144ecfccf559ef14e4d68d2243ff86b4b55bd5ca1c95b88bb44d67693fe3bd15d1c75ead1241668146456a7efe93d6de742c3802bef9368b8b63cbd08ce5a04232f6ddf8537f01459c299c448b760f9c3454c193ded22c7c852a7140a3782df06bd49de8bc86540698ffde04e682983c007c28f82558aac8db52d7f3a72b930fc5cb634fd60d55d96a5ff97cec7b3172e76ee5163599176e010b1050483dbd040d6d47d83ed35a2ca4e84b233b709d986d2daa3a3c8d124ebd0952c0daecce80ac2ffd515956118797d56696443b04d3c3538c730b86b4fd9409cc2013311b1b800dbfd86766717475b59586dfbe23136aee86384b2bf8841fbba8dc95e2d20682da60d9204a82dcd4923b8a9b43cbad8263b22b424b6da1c4d4a491709e73106f1b40d4fd7d1332902f0b121911b33b38d8a9c2041da12db1c8253f393f34a19fe1ad44a70a7c0fb77e89e1d4643566e24edb57168187888caff47289789136ee16c99b798bb8e031668dccc2762221c7999beeffbf8d59bc28287354b4964ea214e8983ad68161d1336682c48940f295bbef84051b8d59fed047968c098ebf77f6a50ed8bd77ce56bb7359aaab957f46571a4afb2e03aa32d5d0a8ac78ec65dcca27a38862e42bfdf3e9c2291ab2811b968ca4dfb856f88cae22c61dbed4fdff14862719e3e898bcf0e0eff5e7eff178ec579c86309a96b8d9380756ffbc3c403b63255fe769aebb797e6629a6ed9503472c40c501a05388cf11e4469fbbcd1e4a85d35ad9bfe754159b7274627b348047fa5c3ae7571d57c45db6a01d70aacbce33e65d276413ce19fffa1d5dc389b9c5e669bc1e3d4fb586a4b5e7edb83ae061cd6f9a2697ad2e16a6e321ce048a8c110fc8d7ed1a4afe4408c5a569f2fab147ed04792d156bf4d3631fa9863bced5bc10521aa6019f7d54a991d7e342a028c2c69b76d54f6278bc41964a32020c44163569901bc7c184f28c2ff8f75ceb90b72c757a48c39dfe7b14e403d0d83d376c92b0b15c880f81a58405b98e6f14d6844c73a57b7f77578d51f3425954c26874580a53ab0a21ce061e56f03d802fdd7e496d8cd8d234c881aa31471e69d08cb2b70b70a6b656aadd95e040a3308e421bce937ea3cf5a3bf2115a7c90bab69fc5a5d27d657ce9d2914c51c41a2d2b23d539796c8929969a19a1e70552fec819c7541e19147dd4604931f6922185fdf0cb633fa198f7c934ea4af0ac8eec29b515da5b9973347d97f64861dd260f9584fc1e3c2eeab7fad188f1cd8ebb4261b9c5ed6fa1670898ba2f0e87ebfef29c0454440da34eadb18f1c203e0d1fcc45d4a22500fe22fc7efa367ceedfa40c010bbf89535f18cf69fa40874524640a4dfdf85a051aac05e1697e17b44f404cd047f9b912fbc859dc28b862db2ca4a96733d248767c81d916580fe00b5f9b185f517bd7a86cc667e5552c8701fe252ec07038a89627cf644761a0585ff0ced73a3a15b40b2811b599b1d002a0568975cab79eda3f4477b6ba37272b3de5c0d99213a675e812ea566ca709986d7b3c8b4b1eb19de03bce346aeaca6cb3628c28f6ae765b07d6b42214c20ba9b66311ac4fdb2bb</script>
</div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E5%85%8D%E6%9D%80/" rel="tag"># 免杀</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/08/06/powershell-jia-zai-shellcode/" rel="next" title="powershell加载shellcode">
                <i class="fa fa-chevron-left"></i> powershell加载shellcode
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/header.jpg"
                alt="Shu1L" />
            
              <p class="site-author-name" itemprop="name">Shu1L</p>
              <p class="site-description motion-element" itemprop="description">欢迎来到Shu1L的神秘小屋！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">64</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="http://xun9er.com/" target="_blank" title="xun9er">
                      
                        <i class="fa fa-fw fa-globe"></i>xun9er</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://hack-for.fun/" target="_blank" title="M0nk3y">
                      
                        <i class="fa fa-fw fa-globe"></i>M0nk3y</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://106.15.121.121/" target="_blank" title="ttpfx">
                      
                        <i class="fa fa-fw fa-globe"></i>ttpfx</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.cnblogs.com/lyxf/" target="_blank" title="l0gan">
                      
                        <i class="fa fa-fw fa-globe"></i>l0gan</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://www.mythe.top/" target="_blank" title="mythe">
                      
                        <i class="fa fa-fw fa-globe"></i>mythe</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://cyzcc.vip/" target="_blank" title="cyzCc">
                      
                        <i class="fa fa-fw fa-globe"></i>cyzCc</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.d0g3.cn/" target="_blank" title="道格安全研究实验室">
                      
                        <i class="fa fa-fw fa-globe"></i>道格安全研究实验室</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shu1L</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
